var arr=[];$.getJSON("servers.json",async r=>{if(r){var e=function(r,e){$(`.server.box[server-id="${e.id}"]`).css("opacity",".5").find(".server.latency").text("? ms").css("background","#ffb2b4"),arr[r].reconnect++,arr[r].reconnect<=5?arr[r].func():$(`.server.box[server-id="${e.id}"] .server.latency`).css("background","#ff8589")};for await(let[s,a]of Object.entries(r)){if("BR"!=a.cc)return;$(".servers.container").append(`<div class="server box" server-id="${a.id}"><div class="server name">${a.sponsor.replace("-","")}</div><div class="server location">${a.name}</div><div class="server latency" style="background:#ffb2b4">? ms</div></div>`),arr[s]={reconnect:0,func:function(){var r,n=new WebSocket(`wss://${a.host}/ws`),c=!1;n.onopen=function(){arr[s].reconnect=0,setInterval(function(){1!=c&&(c=!0,r=Date.now(),n.send("PING "+r))},500)},n.onerror=(()=>e(s,a)),n.onclose=(()=>e(s,a)),n.onmessage=function(e){if(e.data.match("PONG")){var s=Date.now()-r;$(`.server.box[server-id="${a.id}"]`).css("opacity","1").find(".server.latency").text(`${s} ms`).css("background",s>80?"#ffb2b4":s>50?"#ffe8bd":"#fff"),c=!1}}}}}for(i=0;i<arr.length;i++)arr[i].func()}else alert("Erro ao carregar a lista de servidores.")}).fail(()=>{alert("Erro ao carregar a lista de servidores.")});